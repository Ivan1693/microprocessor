<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<!--Customize-->
<script type="text/javascript" src="img-overlay.js"></script>
<link rel="stylesheet" type="text/css" href="master.css">
<!--/Customize--><title>Información para el equipo</title>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-node'><h1><a name="arquitectura-de-computadoras--proyecto" class="md-header-anchor"></a><span>Arquitectura de computadoras : Proyecto</span></h1><h2><a name="generalidades" class="md-header-anchor"></a><span>Generalidades</span></h2><p><span>Mientras buscaba la falla dentro de la ALU en la operación de resta se me ocurrió esta idea de organizar el proyecto, ya que la gran cantidad de archivos que se generan y particularmente la forma de organizarlos del ISE me dificultaron de cierta forma resolver el problema. Comencé tratando de arreglar sólo los archivos y poco del código pero aún así seguía teniendo problemas. Después estudiando y tratando de entender un poco el diseño del microprocesador que el profesor nos dio, y también tratando de redactar un buen reporte, se me ocurrió la idea de dividirlo por módulos y nombrar a estos módulos </span><strong><span>stage</span></strong><span>. Otro factor que me orillo a seguir con la re-estructuración fue el entorno de ISE; si bien corriendo en Linux no es tan lento como en las XP del laboratorio, si es bastante engorroso &quot;debuggear&quot; y hacer pruebas, es por eso que ya habiendo conocido antes el GHDL, opté por escribir el código vhd con </span><strong><span>Sublime Text</span></strong><span> y  utilizar </span><strong><span>GHDL+GTKWave</span></strong><span> como compilador y simulador, mas adelante detallo un poco mas estas herramientas, las cuales me resultaron muy útiles y creo que agilizarón bastante todo el proceso. Las simulaciones están hechas en ISim, su línea de comando hace todo mas fácil.</span></p><blockquote><p><strong><span>stage</span></strong><span> es una analogía a la modificación de autos, en la cual cada stage consiste en dotar al auto de piezas y modificaciones que valla mejorando las prestaciones de este.</span></p></blockquote><p>&nbsp;</p><h2><a name="microstage-1-y-2--gcm" class="md-header-anchor"></a><span>micro_stage 1 y 2 + GCM</span></h2><p><span>Si observamos el diagrama de bloques y recordamos la clase que el profesor nos dio sobre el microprocesador, podemos notar que todo el proceso es secuencial, orquestado por el GCM y  por ende las señales, derivadas del oscilador, A-E.</span></p><p><img class="img-over" src="../schematic/base_microprocessor.png" referrerpolicy="no-referrer" alt="fig1"></p><blockquote><p><span>Diagrama original del microprocesador de 4 bits</span></p></blockquote><p><span>Es por eso que los stages se dividen en función de las señales A-D y A,E para el </span><code>micro_stage1</code><span>y </span><code>micro_stage2</code><span> respectivamente. Si revisan el </span><a href='Microprocesador - Stage 1.md'><span>reporte</span></a><span> que anexo de ese primer módulo, trato de describir cada parte que lo compone y algunas consideraciones que hicimos para el diseño. El siguiente diagrama muestra el diseño del procesador de manera muy compacta y la segmentación propuesta.</span></p><p><img class="img-over" src="../schematic/Microprocessor.png" referrerpolicy="no-referrer" alt="fig2"></p><blockquote><p><span>Segmentación propuesta para el microprocesador.</span></p></blockquote><p>&nbsp;</p><h2><a name="organización-del-proyecto" class="md-header-anchor"></a><span>Organización del proyecto</span></h2><p><span>El root del proyecto es el directorio </span><code>miroprocessor</code><span>, el directorio </span><code>project</code><span>organiza por carpetas los proyectos de </span><strong><span>ISE</span></strong><span> de los módulos </span><code>micro_stage1</code><span>y </span><code>micro_stage2</code><span> y de la integración final como </span><code>microprocessor_4bits</code><span> (estos dos últimos por desarrollar). El directorio </span><code>doc</code><span>contiene archivos de documentación, diagramas, etc. Finalmente todo el código VHD se organiza en el directorio </span><code>source</code><span>(checar el árbol de paquetes en el </span><a href='Microprocesador - Stage 1.md'><span>reporte</span></a><span>). Dentro de source existe un directorio llamado </span><code>simulations</code><span>, este contiene los archivos testbench (*.vhd) para las simulaciones de los módulos y  dentro del directorio </span><code>testbench</code><span> para varias de las entidades que están declaradas en los paquetes; en el directorio </span><code>vcd</code><span>dentro de testbench se almacenan los archivos de simulación de GTKWave con extensión VCD.</span></p><p><img src="../images/project_tree.jpg" referrerpolicy="no-referrer"></p><p>&nbsp;</p><h2><a name="ghdl--gtkwave-comandos-básicos-y-simulación" class="md-header-anchor"></a><span>GHDL + GTKWave: Comandos básicos y simulación</span></h2><p><span>Para la organización y re-estructuración de los archivos del proyecto utilicé el simulador de VHDL, GHDL. El funcionamiento de este simulador es similar al compilador </span><code>GCC</code><span>, y bastante rápido. Ademas de analizar sintaxis permite la ejecución del código VHDL (simulación) implementando un testbench (entidad sin puertos, caja cerrada, en el cual se utilizan sólo señales), todo esto directamente en terminal. El resultado de dicha simulación se puede mandar como salida a un archivo </span><code>.vcd</code><span>y posteriormente visualizarlo con </span><code>GTKWave</code><span>, el cual es un software que permite observar el comportamiento de los puertos y señales instanciados en el testbench a diferentes niveles. La única que desventaja que tiene GTKWave, contra el simulador del ISE por ejemplo, es que no se pueden forzar constantes, para hacer un cambio en los valores de las señales es necesario cambar dicho valor directamente en el archivo VHD del testbench, compilar, analizar y recargar la simulación. Sin embargo, dado que esta compilación y análisis de los archivos se hace directamente en terminal, es posible implementar scripts de shell para hacerlo.</span></p><p><strong><span>Instalación de GHDL y GTKWave</span></strong></p><p><span>La gran ventaja de la terminal! Para la instalación del GHDL y GTKWave sólo es necesario el siguiente comando:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8.16406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ sudo</span> apt-get install ghdl gtkwave</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 20px;"></div><div class="CodeMirror-gutters" style="display: none; height: 20px;"></div></div></div></pre><blockquote><p><strong><span>Link:</span></strong><span> </span><a href='https://vhdl.es/simulador-vhdl-gratuito/'><span>Simulador VHDL gratuito. GHDL</span></a></p></blockquote><h2><a name="ejemplo-del-proceso-de-simulación-con-ghdl" class="md-header-anchor"></a><span>Ejemplo del proceso de simulación con GHDL</span></h2><p><span>Supongamos que queremos simular el comportamiento de un contador de 3 bits de 0 a 5 (pensaba implementarlo con el decodificador de 4 bits a 7 segmentos) declarado en el paquete </span><code>basic_devs</code><span>, el archivo de dicho contador </span><code>conta305.vhd</code><span> es el siguiente:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="vhdl" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="vhdl"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8.16406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">-- conta305 -&gt; conta[tamaño en bits][inicio][fin]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">library</span> <span class="cm-variable">ieee</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">use</span> <span class="cm-variable">ieee</span>.<span class="cm-variable">std_logic_1164</span>.<span class="cm-keyword">all</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">entity</span> <span class="cm-variable">conta305</span> <span class="cm-keyword">is</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">port</span> (</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span> <span class="cm-variable">clk</span>: <span class="cm-keyword">in</span> <span class="cm-variable">std_logic</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span> <span class="cm-variable">count</span>: <span class="cm-keyword">out</span> <span class="cm-variable">std_logic_vector</span>(<span class="cm-number">2</span> <span class="cm-keyword">downto</span> <span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  );</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span> <span class="cm-keyword">entity</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">architecture</span> <span class="cm-variable">behavioral</span> <span class="cm-keyword">of</span> <span class="cm-variable">conta305</span> <span class="cm-keyword">is</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">signal</span> <span class="cm-variable">delta</span>: <span class="cm-variable">std_logic_vector</span>(<span class="cm-number">2</span> <span class="cm-keyword">downto</span> <span class="cm-number">0</span>):<span class="cm-operator">=</span><span class="cm-string-2">"000"</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">begin</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">process</span>(<span class="cm-variable">clk</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">begin</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span>(<span class="cm-variable">clk</span><span class="cm-operator">=</span><span class="cm-string">'1'</span>) <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">delta</span> <span class="cm-operator">&lt;=</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>((<span class="cm-variable">not</span> <span class="cm-variable">delta</span>(<span class="cm-number">2</span>) <span class="cm-keyword">and</span> <span class="cm-variable">delta</span>(<span class="cm-number">1</span>) <span class="cm-keyword">and</span> <span class="cm-variable">delta</span>(<span class="cm-number">0</span>)) <span class="cm-keyword">or</span> (<span class="cm-variable">delta</span>(<span class="cm-number">2</span>) <span class="cm-keyword">and</span> <span class="cm-variable">not</span> <span class="cm-variable">delta</span>(<span class="cm-number">0</span>) <span class="cm-keyword">and</span> <span class="cm-variable">not</span> <span class="cm-variable">delta</span>(<span class="cm-number">1</span>))) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>(<span class="cm-variable">not</span> <span class="cm-variable">delta</span>(<span class="cm-number">2</span>) <span class="cm-keyword">and</span> (<span class="cm-variable">delta</span>(<span class="cm-number">0</span>) <span class="cm-keyword">xor</span> <span class="cm-variable">delta</span>(<span class="cm-number">1</span>))) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>(<span class="cm-variable">not</span> <span class="cm-variable">delta</span>(<span class="cm-number">0</span>) <span class="cm-keyword">and</span> (<span class="cm-variable">not</span> <span class="cm-variable">delta</span>(<span class="cm-number">1</span>) <span class="cm-keyword">or</span> <span class="cm-variable">not</span> <span class="cm-variable">delta</span>(<span class="cm-number">2</span>)));</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">count</span> <span class="cm-operator">&lt;=</span> <span class="cm-variable">delta</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">end</span> <span class="cm-keyword">if</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">end</span> <span class="cm-keyword">process</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span> <span class="cm-keyword">architecture</span>;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 500px;"></div><div class="CodeMirror-gutters" style="display: none; height: 500px;"></div></div></div></pre><p><span>El archivo de testbench </span><code>conta305_tb.vhd</code><span> es el siguiente:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="vhdl" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="vhdl"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8.16406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">library</span> <span class="cm-variable">ieee</span>;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">use</span> <span class="cm-variable">ieee</span>.<span class="cm-variable">std_logic_1164</span>.<span class="cm-keyword">all</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">use</span> <span class="cm-variable">work</span>.<span class="cm-variable">basic_devs</span>.<span class="cm-variable">conta305</span>; <span class="cm-comment">-- Incluímos el componente desde basic_devs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">entity</span> <span class="cm-variable">conta305tb</span> <span class="cm-keyword">is</span> <span class="cm-comment">-- Caja cerrada</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span> <span class="cm-keyword">entity</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">architecture</span> <span class="cm-variable">conta305_test</span> <span class="cm-keyword">of</span> <span class="cm-variable">conta305tb</span> <span class="cm-keyword">is</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">signal</span> <span class="cm-variable">clk</span>: <span class="cm-variable">std_logic</span>:<span class="cm-operator">=</span><span class="cm-string">'0'</span>; <span class="cm-comment">-- Señal de reloj</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">signal</span> <span class="cm-variable">out_cont</span>: <span class="cm-variable">std_logic_vector</span>(<span class="cm-number">2</span> <span class="cm-keyword">downto</span> <span class="cm-number">0</span>); <span class="cm-comment">-- Señal a conectar a la salida del contador</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">begin</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">clk</span> <span class="cm-operator">&lt;=</span> <span class="cm-variable">not</span>(<span class="cm-variable">clk</span>) <span class="cm-keyword">after</span> <span class="cm-number">1</span> <span class="cm-variable">ns</span>; <span class="cm-comment">-- Simulamos un ciclo de reloj de 2 ns</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">conta305_block</span>: <span class="cm-variable">conta305</span> <span class="cm-keyword">port</span> <span class="cm-keyword">map</span>(<span class="cm-variable">clk</span>, <span class="cm-variable">out_cont</span>); <span class="cm-comment">-- Instanciamos el contador</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">end</span> <span class="cm-keyword">architecture</span>;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 280px;"></div><div class="CodeMirror-gutters" style="display: none; height: 280px;"></div></div></div></pre><p><span>Con los dos archivos listos procedemos a analizar, en primer lugar el archivo del contador, seguido del archivo del testbench. Si se hacen cambios en el archivo de paquete, GHDL avisará que ha habido cambios y es necesario re-analizar, si se da el caso simplemente se analiza dicho archivo.  Una vez completados los análisis ejecutamos el código y finalmente corremos GTKWave con el archivo VCD como argumento. El procedimiento se muestra a continuación:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8.16406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ ghdl</span> <span class="cm-attribute">-a</span> conta305.vhd</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ ghdl</span> <span class="cm-attribute">-a</span> conta305_tb.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ ghdl</span> <span class="cm-attribute">-r</span> conta305tb <span class="cm-attribute">--vcd</span><span class="cm-operator">=</span>simulacion.vcd <span class="cm-attribute">--stop-time</span><span class="cm-operator">=</span>12ns</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ gtkwave</span> simulacion.vcd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl:info: simulation stopped by <span class="cm-attribute">--stop-time</span> @12ns</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 100px;"></div><div class="CodeMirror-gutters" style="display: none; height: 100px;"></div></div></div></pre><blockquote><p><span>Notemos que para hacer la ejecución de la simulación se hace con el nombre de la entidad como argumento, no con el nombre del archivo. </span></p></blockquote><p><span>El resultado de la simulación debe ser el siguiente:</span></p><p><img alt="fig3" class="img-over" src="../images/sim_1.png" style="zoom: 100%;" /></p><blockquote><p><span>Se observa que durante el primer nano segundo el valor de la señal </span><code>out_count</code><span> es indefinido dado que se comienza el pulso de reloj en bajo.</span></p></blockquote><h3><a name="bash-scripts" class="md-header-anchor"></a><span>Bash Scripts</span></h3><p><span>Como he mencionado dicho proceso puede llegar a ser un poco tedioso sin el uso de un script. A continuación se muestra un ejemplo de script para analizar y ejecutar la simulación anterior con algunos mensajes de control.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8.16406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#!/bin/bash</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#Códigos de colores en UTF-para imprimir en términal</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">RED</span><span class="cm-operator">=</span><span class="cm-string">'\033[0;31m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">GRN</span><span class="cm-operator">=</span><span class="cm-string">'\033[0;32m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">LBL</span><span class="cm-operator">=</span><span class="cm-string">'\033[1;34m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">YLW</span><span class="cm-operator">=</span><span class="cm-string">'\033[1;33m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">NC</span><span class="cm-operator">=</span><span class="cm-string">'\033[0m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">SIMNAME</span><span class="cm-operator">=</span><span class="cm-def">$1</span> <span class="cm-comment">#Se guarda la cadena del primer argumento como variable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">NONAME</span><span class="cm-operator">=</span><span class="cm-string">""</span> <span class="cm-comment">#Cadena vacía para identificar la ausencia de argumentos</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"&gt;Analizar </span><span class="cm-def">${LBL}</span><span class="cm-string">conta305.vhd</span><span class="cm-def">${NC}</span><span class="cm-string">"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl <span class="cm-attribute">-a</span> conta305.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"&gt;Analizar testbench </span><span class="cm-def">${LBL}</span><span class="cm-string">stage1_sim.vhd</span><span class="cm-def">${NC}</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl <span class="cm-attribute">-a</span> conta305_tb.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"&gt;Correr testbench"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#Asignación de nombre de archivo de salida</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> [ <span class="cm-string">"</span><span class="cm-def">$SIMNAME</span><span class="cm-string">"</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-def">$NONAME</span><span class="cm-string">"</span> ]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" archivo de simulacion: </span><span class="cm-def">${YLW}</span><span class="cm-string">simulation.vcd</span><span class="cm-def">${NC}</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">SIMNAME</span><span class="cm-operator">=</span><span class="cm-string">"simulation.vcd"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" archivo de simulacion: </span><span class="cm-def">${YLW}$SIMNAME${NC}</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl <span class="cm-attribute">-r</span> conta305tb <span class="cm-attribute">--vcd</span><span class="cm-operator">=</span><span class="cm-def">$SIMNAME</span> <span class="cm-attribute">--stop-time</span><span class="cm-operator">=</span>12ns</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">COMPK</span><span class="cm-operator">=</span><span class="cm-def">$?</span> <span class="cm-comment">#Almacena el valor que devuelve GHDL al terminar su ejecución. En caso de éxito este valor es cero,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> [[ <span class="cm-def">COMPK</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"&gt;Simulacion [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">fi</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 600px;"></div><div class="CodeMirror-gutters" style="display: none; height: 600px;"></div></div></div></pre><blockquote><p><span>En el script evito correr GTKWave por si la simulación falla o surge algún inconveniente.</span></p></blockquote><p><span>Existen dos maneras de ejecutar el script. La primera es directamente como argumento de </span><code>bash</code><span>:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8.16406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ bash</span> makesim.sh simulacion_contador.vcd</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;Analizar conta305.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;Analizar testbench conta305_tb.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;Correr testbench</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> archivo de simulacion: simulacion_contador.vcd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl:info: simulation stopped by <span class="cm-attribute">--stop-time</span> @12ns</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;Simulacion [OK]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ gtkwave</span> simulacion_contador.vcd</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 160px;"></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></pre><p><span>La segunda es asignando el permiso de ejecución al script mediante </span><code>chmod</code><span>;</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8.16406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ chmod</span> <span class="cm-operator">+</span>x makesim.sh</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ </span>./makesim.sh simulacion_contador.vcd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;Analizar conta305.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;Analizar testbench conta305_tb.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;Correr testbench</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> archivo de simulacion: simulacion_contador.vcd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl:info: simulation stopped by <span class="cm-attribute">--stop-time</span> @12ns</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">&gt;Simulacion [OK]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ gtkwave</span> simulacion_contador.vcd</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 180px;"></div><div class="CodeMirror-gutters" style="display: none; height: 180px;"></div></div></div></pre><h4><a name="script-para-analizar-paquetes" class="md-header-anchor"></a><span>Script para analizar paquetes </span></h4><p><span>Como mencioné anteriormente, en ocasiones GHDL pide analizar el archivo de paquetes o el archivo donde se hace la descripción del componente que queremos simular; el problema surge conforme se van generando mas y mas archivos pues muchas veces es necesario re-analizar casi la totalidad el proyecto. Es por eso que decidí separar en carpetas los archivos pertenecientes a cada uno de los paquetes, para de esta forma implementar un script para hacer el análisis de todos los archivos del proyecto con sólo la ejecución del script. Nombré a este script </span><code>analize_tree.sh</code><span>haciendo referencia al árbol de paquetes que se describe en el reporte. </span></p><blockquote><p><span>El archivo que genera GHDL, </span><strong><span>work-obj93.cf</span></strong><span>, contiene toda la información de la librería </span><strong><span>work</span></strong><span>, que es la que organiza por defecto todos los paquetes. Cada acción de análisis sobre cualquier archivo actualiza el archivo </span><strong><span>work-obj93.cf</span></strong><span>, sin embargo es recomendable eliminar y volver a generar dicho archivo cuando se analizan varios archivos a la vez, es por eso que se define la bandera </span><em><span>-r</span></em><span> como argumento del script, para eliminar y volver a generar.</span></p></blockquote><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8.16406px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#!/bin/bash</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">RED</span><span class="cm-operator">=</span><span class="cm-string">'\033[0;31m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">GRN</span><span class="cm-operator">=</span><span class="cm-string">'\033[0;32m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">LBL</span><span class="cm-operator">=</span><span class="cm-string">'\033[1;34m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">YLW</span><span class="cm-operator">=</span><span class="cm-string">'\033[1;33m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">NC</span><span class="cm-operator">=</span><span class="cm-string">'\033[0m'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">VAR1</span><span class="cm-operator">=</span><span class="cm-def">$1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">VAR2</span><span class="cm-operator">=</span><span class="cm-string">"-r"</span> <span class="cm-comment">#Bandera para eliminar y volver a generar el archivo work-obj93.cf</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## Puro adorno</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${LBL}</span><span class="cm-string">ESCOM</span><span class="cm-def">${NC}</span><span class="cm-string"> Arquitectura de computadoras: Microcontrolador 4bits\nAnalisis de codigo fuente de paquetes y componentes con GHDL \n"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> [ <span class="cm-string">"</span><span class="cm-def">$VAR1</span><span class="cm-string">"</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-def">$VAR2</span><span class="cm-string">"</span> ]; <span class="cm-keyword">then</span> <span class="cm-comment">#Verifica si se ha activado la bandera de "reset" del archivo work-93.c</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">&gt; Recompilar:</span><span class="cm-def">${NC}</span><span class="cm-string"> work-obj93.cf"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">rm</span> work-obj93.cf <span class="cm-comment">#En caso verdadero elimina dicho archivo</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment">#GHDL lo vuelve a generar una vez que hace el primer análisis</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"&gt; actualizar work-obj93.cf"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"&gt; analizar paquete de basicos"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl <span class="cm-attribute">-a</span> basic_devs.vhd <span class="cm-comment"># Analiza paquete</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">compok</span><span class="cm-operator">=</span><span class="cm-def">$?</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> [[ <span class="cm-def">compok</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" &nbsp;</span><span class="cm-def">${YLW}</span><span class="cm-string">basic_devs.vhd</span><span class="cm-def">${NC}</span><span class="cm-string"> [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]\n&gt; analizar directorio basic/"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">files</span><span class="cm-operator">=</span><span class="cm-quote">$(ls basic/*.vhd)</span> <span class="cm-comment">#Obtiene todos los archivos .vhd del directorio correspondiente</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">for</span> i <span class="cm-keyword">in</span> <span class="cm-def">$files</span> ; <span class="cm-keyword">do</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>ghdl <span class="cm-attribute">-a</span> <span class="cm-def">$i</span> <span class="cm-comment">#Analiza cada uno de los archivos almacenados en el vector files</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">compok</span><span class="cm-operator">=</span><span class="cm-def">$?</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> [[ <span class="cm-def">compok</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" &nbsp;</span><span class="cm-def">${LBL}$i${NC}</span><span class="cm-string"> [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]"</span> <span class="cm-comment">#Comfirma el análisis</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">Error</span><span class="cm-def">${NC}</span><span class="cm-string"> al analizar </span><span class="cm-def">${LBL}$i${NC}</span><span class="cm-string">"</span> <span class="cm-comment">#Falló análisis de archivo</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">exit</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">done</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">Error</span><span class="cm-def">${NC}</span><span class="cm-string"> al analizar basic_devs.vhd"</span> <span class="cm-comment">#Falló análisis de paquete</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">exit</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#Y de manera análoga con los demás paquetes ---&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"&gt; analizar paquete de memoria"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl <span class="cm-attribute">-a</span> memory_devs.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">compok</span><span class="cm-operator">=</span><span class="cm-def">$?</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> [[ <span class="cm-def">compok</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" &nbsp;</span><span class="cm-def">${YLW}</span><span class="cm-string">memory_devs.vhd</span><span class="cm-def">${NC}</span><span class="cm-string"> [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]\n&gt; analizar directorio memory/"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">files</span><span class="cm-operator">=</span><span class="cm-quote">$(ls memory/*.vhd)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">for</span> i <span class="cm-keyword">in</span> <span class="cm-def">$files</span> ; <span class="cm-keyword">do</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>ghdl <span class="cm-attribute">-a</span> <span class="cm-def">$i</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">compok</span><span class="cm-operator">=</span><span class="cm-def">$?</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> [[ <span class="cm-def">compok</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" &nbsp;</span><span class="cm-def">${LBL}$i${NC}</span><span class="cm-string"> [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">Error</span><span class="cm-def">${NC}</span><span class="cm-string"> al analizar </span><span class="cm-def">${LBL}$i${NC}</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">exit</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">done</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">Error</span><span class="cm-def">${NC}</span><span class="cm-string"> al analizar memory_devs.vhd"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">exit</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"&gt; analizar paquete de alu"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl <span class="cm-attribute">-a</span> alu_devs.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">compok</span><span class="cm-operator">=</span><span class="cm-def">$?</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> [[ <span class="cm-def">compok</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" &nbsp;</span><span class="cm-def">${YLW}</span><span class="cm-string">alu_devs.vhd</span><span class="cm-def">${NC}</span><span class="cm-string"> [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]\n&gt; analizar directorio alu/"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">files</span><span class="cm-operator">=</span><span class="cm-quote">$(ls alu/*.vhd)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">for</span> i <span class="cm-keyword">in</span> <span class="cm-def">$files</span> ; <span class="cm-keyword">do</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>ghdl <span class="cm-attribute">-a</span> <span class="cm-def">$i</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">compok</span><span class="cm-operator">=</span><span class="cm-def">$?</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> [[ <span class="cm-def">compok</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" &nbsp;</span><span class="cm-def">${LBL}$i${NC}</span><span class="cm-string"> [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">Error</span><span class="cm-def">${NC}</span><span class="cm-string"> al analizar </span><span class="cm-def">${LBL}$i${NC}</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">exit</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">done</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">Error</span><span class="cm-def">${NC}</span><span class="cm-string"> al analizar alu_devs.vhd"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">exit</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"&gt; analizar paquete de micro"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ghdl <span class="cm-attribute">-a</span> micro_devs.vhd</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> [[ <span class="cm-def">compok</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" &nbsp;</span><span class="cm-def">${YLW}</span><span class="cm-string">micro_devs.vhd</span><span class="cm-def">${NC}</span><span class="cm-string"> [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]\n&gt; analizar directorio micro/"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">files</span><span class="cm-operator">=</span><span class="cm-quote">$(ls micro/*.vhd)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">for</span> i <span class="cm-keyword">in</span> <span class="cm-def">$files</span> ; <span class="cm-keyword">do</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span>ghdl <span class="cm-attribute">-a</span> <span class="cm-def">$i</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-def">compok</span><span class="cm-operator">=</span><span class="cm-def">$?</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">if</span> [[ <span class="cm-def">compok</span><span class="cm-operator">==</span><span class="cm-number">0</span> ]]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">" &nbsp;</span><span class="cm-def">${LBL}$i${NC}</span><span class="cm-string"> [</span><span class="cm-def">${GRN}</span><span class="cm-string">OK</span><span class="cm-def">${NC}</span><span class="cm-string">]"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">Error</span><span class="cm-def">${NC}</span><span class="cm-string"> al analizar </span><span class="cm-def">${LBL}$i${NC}</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">exit</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">done</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-builtin">echo</span> <span class="cm-attribute">-e</span> <span class="cm-string">"</span><span class="cm-def">${RED}</span><span class="cm-string">Error</span><span class="cm-def">${NC}</span><span class="cm-string"> al analizar micro_devs.vhd"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">exit</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-keyword">fi</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 2060px;"></div><div class="CodeMirror-gutters" style="display: none; height: 2060px;"></div></div></div></pre><p><span>En caso de que exista algún error en algún archivo, GHDL lo reporta y se continua con el análisis. Regularmente estos errores implican otros errores en otros archivos, por lo cual lo ideal es corregir y volver a analizar. Este script se encuentra en la carpeta source junto con </span><em><span>makesim.sh</span></em><span> que funciona de forma similar al script anterior.</span></p><div style="page-break-after: always; break-after: page;"></div><h2><a name="notas" class="md-header-anchor"></a><span>Notas:</span></h2><blockquote><p><span>El propósito principal de esta redacción junto con el reporte es explicar como funciona esta parte del proyecto que se tiene y también proponer esta forma de trabajo para completar el microprocesador, prácticamente sólo falta el contador de programa y el decodificador de instrucciones. En el testbench </span><code>source/sims/top_sim.vhd</code><span> se crea un &quot;mini GCM&quot; de 4 señales con un contador de 0 a 3 y un demultiplexor de 1 a 4, para tener el GCM final sólo se deben extender un bit ambos componentes.</span></p></blockquote><blockquote><p><span>El acarreo del dato de 5 bits almacenado en el registro ACM permanece desconectado hasta este momento. Una forma de especificar el uso de este puede ser mediante la misma instrucción. Creo que eso debe adecuarse una vez que se sepa el formato final de las instrucciones y la instrucciones en sí que estarán almacenadas en la memoria de programa.</span></p></blockquote><h4><a name="respecto-a-la-documentación" class="md-header-anchor"></a><span>Respecto a la documentación</span></h4><blockquote><p><span>Para hacer estos documentos utilicé </span><strong><span>markdown</span></strong><span> y el software </span><a href='https://www.typora.io/'><strong><span>Typora</span></strong></a><span>. Agilizan bastante el proceso de documentación. Anexo las versiones PDF que para mi gusto resultan un tanto desordenadas, por lo cual también anexo la versión </span><a href='microprocesador_stage_1.html'><span>HTML</span></a><span> a la que le agregue uno que otro truco. Estoy trabajando en un tema personalizado de Typora para los PDF&#39;s.</span></p></blockquote><blockquote><p><span>Para los diagramas de los circuitos utilicé </span><a href='https://www.draw.io/'><span>draw.io</span></a><span>. Es un editor de gráficos vectoriales muy bueno y se utliza con drive. Les comparto el </span><a href='https://drive.google.com/drive/folders/1BE7Lbbq0alqQRE5xtO7kfgk1HyXLJ6ZM?usp=sharing'><span>link</span></a><span> a la carpeta del proyecto que tengo en drive y dónde almaceno los diagramas.</span></p></blockquote><p>&nbsp;</p></div>
</body>
</html>